
### Difficulty: Medium


### Challenge Info: 
**Description:**
We've intercepted a malicious file that seems to be performing some harmful actions. Can you figure out what it's doing? The password to decrypt the ZIP file is `infected`.

**Note:** The malicious actions have been removed, but this file will still trigger Anti-Virus detections.

**Author:** m4lwhere
Package Link: [Download Here](https://github.com/m4lwhere/DoD-CyberChallenge-C1-Challenges/tree/main/ferromagnetic/Challenge_Artifacts)

**Instructions:**
1. **Anti-Virus Warning:** If you are downloading this on Windows, your anti-virus or firewall may block the download. You may need to disable your firewall or anti-virus software to proceed. **(Do this at your own risk.)**

2. **Decryption:**
   - Use the password `infected` to unzip the file.

3. **Inspection:**
   - Inside the unzipped file, you will find a PowerShell script. Open this script in PowerShell ISE or any text editor to examine the content.
   - You will notice a long Base64 string assigned to a variable `DoIt`.

4. **Decoding:**
   - Copy the Base64 string and decode it. This reveals a segment of function code.
   - As you scroll further, you will find another Base64 string. But before decoding this second string, observe the following function in the script:

     ```powershell
     $var_code[$x] = $var_code[$x] -bxor 35
     ```

5. **Decoding with XOR:**
   - The code is being XORed with 35. To decode it correctly:
     - Copy the entire string that is being converted.
     - Use a tool like CyberChef.
     - Set the recipe to "From Base64" followed by "XOR".
     - Set the XOR key to 35 and run the recipe.

6. **Flag:**
   - After running the recipe, the flag will be revealed:
     ```
     C1{malware_obfuscat10n_4nd_m4n1pul4ti0n!}
     ```
